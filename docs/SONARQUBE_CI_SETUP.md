# SonarQube CI Setup Guide

This guide explains how to set up SonarCloud integration for automated code quality and security analysis on GitHub.

## üîß Setup Steps

### 1. SonarCloud Account Setup

1. **Sign up for SonarCloud:**
   - Go to [sonarcloud.io](https://sonarcloud.io)
   - Sign in with your GitHub account
   - Grant necessary permissions

2. **Import your repository:**
   - Click "+" ‚Üí "Analyze new project"
   - Select your GitHub organization: `Dino-pit-studios-llc`
   - Choose the `DinoAir3` repository
   - Click "Set up"

### 2. GitHub Repository Secrets

Add these secrets in your GitHub repository settings (`Settings` ‚Üí `Secrets and variables` ‚Üí `Actions`):

```
SONAR_TOKEN=<your-sonarcloud-token>
```

**To get your SONAR_TOKEN:**
1. In SonarCloud, go to [My Account](https://sonarcloud.io/account/security/) ‚Üí Security
2. Generate a new token with a descriptive name (e.g., "DinoAir3-GitHub-Actions")
3. Copy the token and add it as a GitHub secret

### 3. Organization Key (Already Configured)

Your SonarCloud organization key is already set in `sonar-project.properties`:
```
sonar.organization=dino-pit-studios-llc
```

## üìã What's Configured

### Automated Analysis
- **Code Quality:** Detects bugs, vulnerabilities, and code smells
- **Security:** Identifies security hotspots and vulnerabilities
- **Coverage:** Tracks test coverage metrics
- **Duplication:** Finds code duplication issues
- **Maintainability:** Measures technical debt

### Integrated Tools
- **Python Coverage:** Uses `pytest-cov` for coverage reports
- **Bandit Security:** Scans for security issues in Python code
- **Quality Gate:** Enforces quality standards before merging

### Workflow Triggers
- **Push to main/develop:** Full analysis
- **Pull Requests:** Differential analysis showing new issues
- **Quality Gate:** Blocks merging if quality standards aren't met

## üöÄ Usage

### Automatic Analysis
Once configured, SonarCloud will automatically:
1. Analyze every push to `main` and `develop` branches
2. Analyze all pull requests
3. Comment on PRs with code quality feedback
4. Display results in the SonarCloud dashboard

### Manual Triggers
You can also trigger analysis manually:
```bash
# Run locally (requires sonar-scanner)
sonar-scanner
```

### GitHub Actions
Two workflows are configured:

1. **`.github/workflows/ci.yml`** - Integrated SonarQube job
2. **`.github/workflows/sonarcloud.yml`** - Dedicated SonarCloud workflow

## üìä Viewing Results

### SonarCloud Dashboard
- **URL:** [sonarcloud.io/project/overview?id=Dino-pit-studios-llc_DinoAir3](https://sonarcloud.io/project/overview?id=Dino-pit-studios-llc_DinoAir3)
- **Metrics:** Coverage, duplications, maintainability rating
- **Issues:** Security hotspots, bugs, vulnerabilities, code smells

### GitHub Integration
- **PR Comments:** SonarCloud bot comments on PRs with analysis
- **Status Checks:** Quality gate status appears in PR checks
- **Badges:** Add repository badges to README

## üõ°Ô∏è Security Configuration

### What's Analyzed
- **Security Hotspots:** Code patterns requiring security review
- **Vulnerabilities:** Known security vulnerabilities
- **Bandit Integration:** Python-specific security analysis
- **Dependency Scanning:** Vulnerable dependency detection

### Coverage Configuration
```properties
# Configured in sonar-project.properties
sonar.python.coverage.reportPaths=coverage.xml
sonar.python.xunit.reportPath=test-results.xml
sonar.python.bandit.reportPaths=bandit-report.json
```

## üéØ Quality Gate

The quality gate is configured to:
- ‚úÖ Require 80%+ coverage on new code
- ‚úÖ Zero new bugs
- ‚úÖ Zero new vulnerabilities
- ‚úÖ A-rated maintainability for new code
- ‚úÖ Maximum 3% duplication on new code

## üîç Customization

### Exclude Files
Edit `sonar-project.properties` to exclude additional files:
```properties
sonar.exclusions=**/*.log,**/additional-pattern/**
```

### Quality Gate Rules
Customize quality gate rules in SonarCloud:
1. Go to "Administration" ‚Üí "Quality Gates"
2. Create a custom quality gate
3. Set your project to use the custom gate

## üö® Troubleshooting

### Common Issues

**Token Authentication:**
- Ensure `SONAR_TOKEN` secret is correctly set
- Token should have appropriate permissions

**Coverage Not Showing:**
- Verify `coverage.xml` is generated by pytest
- Check coverage report paths in configuration

**Analysis Failing:**
- Check GitHub Actions logs for detailed error messages
- Verify all dependencies are installed correctly

### Support
- **SonarCloud Docs:** [docs.sonarcloud.io](https://docs.sonarcloud.io)
- **GitHub Actions:** [docs.github.com/actions](https://docs.github.com/en/actions)
- **Project Issues:** Create an issue in this repository

## üìà Benefits

‚úÖ **Automated Quality Assurance:** Every PR gets quality analysis  
‚úÖ **Security Scanning:** Identify vulnerabilities before deployment  
‚úÖ **Code Coverage Tracking:** Monitor test coverage trends  
‚úÖ **Technical Debt Management:** Track and reduce technical debt  
‚úÖ **Team Code Reviews:** Consistent quality standards across team  
‚úÖ **Continuous Improvement:** Quality metrics and trends over time  

---

**Next Steps:**
1. Add `SONAR_TOKEN` to GitHub secrets
2. Push a commit to trigger the first analysis
3. Review results in SonarCloud dashboard
4. Configure quality gate preferences
5. Add SonarCloud badge to README